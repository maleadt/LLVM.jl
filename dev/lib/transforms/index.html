<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Transforms · LLVM.jl</title><meta name="title" content="Transforms · LLVM.jl"/><meta property="og:title" content="Transforms · LLVM.jl"/><meta property="twitter:title" content="Transforms · LLVM.jl"/><meta name="description" content="Documentation for LLVM.jl."/><meta property="og:description" content="Documentation for LLVM.jl."/><meta property="twitter:description" content="Documentation for LLVM.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">LLVM.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Usage</span><ul><li><a class="tocitem" href="../../man/essentials/">Essentials</a></li><li><a class="tocitem" href="../../man/types/">Types</a></li><li><a class="tocitem" href="../../man/values/">Values</a></li><li><a class="tocitem" href="../../man/modules/">Modules</a></li><li><a class="tocitem" href="../../man/functions/">Functions</a></li><li><a class="tocitem" href="../../man/blocks/">Basic blocks</a></li><li><a class="tocitem" href="../../man/instructions/">Instructions</a></li><li><a class="tocitem" href="../../man/metadata/">Metadata</a></li><li><a class="tocitem" href="../../man/analyses/">Analyses</a></li><li><a class="tocitem" href="../../man/transforms/">Transforms</a></li><li><a class="tocitem" href="../../man/codegen/">Code generation</a></li><li><a class="tocitem" href="../../man/execution/">Execution</a></li><li><a class="tocitem" href="../../man/interop/">Julia integration</a></li></ul></li><li><span class="tocitem">API reference</span><ul><li><a class="tocitem" href="../essentials/">Essentials</a></li><li><a class="tocitem" href="../types/">Types</a></li><li><a class="tocitem" href="../values/">Values</a></li><li><a class="tocitem" href="../modules/">Modules</a></li><li><a class="tocitem" href="../functions/">Functions</a></li><li><a class="tocitem" href="../blocks/">Basic blocks</a></li><li><a class="tocitem" href="../instructions/">Instructions</a></li><li><a class="tocitem" href="../metadata/">Metadata</a></li><li><a class="tocitem" href="../analyses/">Analyses</a></li><li class="is-active"><a class="tocitem" href>Transforms</a><ul class="internal"><li><a class="tocitem" href="#Pass-builders"><span>Pass builders</span></a></li><li><a class="tocitem" href="#Pass-managers"><span>Pass managers</span></a></li><li><a class="tocitem" href="#Alias-analyses"><span>Alias analyses</span></a></li><li><a class="tocitem" href="#Custom-passes"><span>Custom passes</span></a></li><li><a class="tocitem" href="#IR-cloning"><span>IR cloning</span></a></li></ul></li><li><a class="tocitem" href="../codegen/">Code generation</a></li><li><a class="tocitem" href="../execution/">Execution</a></li><li><a class="tocitem" href="../interop/">Julia integration</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API reference</a></li><li class="is-active"><a href>Transforms</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Transforms</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/maleadt/LLVM.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/maleadt/LLVM.jl/blob/master/docs/src/lib/transforms.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Transforms"><a class="docs-heading-anchor" href="#Transforms">Transforms</a><a id="Transforms-1"></a><a class="docs-heading-anchor-permalink" href="#Transforms" title="Permalink"></a></h1><h2 id="Pass-builders"><a class="docs-heading-anchor" href="#Pass-builders">Pass builders</a><a id="Pass-builders-1"></a><a class="docs-heading-anchor-permalink" href="#Pass-builders" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LLVM.NewPMPassBuilder" href="#LLVM.NewPMPassBuilder"><code>LLVM.NewPMPassBuilder</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">NewPMPassBuilder(; verify_each=false, debug_logging=false, pipeline_tuning_kwargs...)</code></pre><p>Create a new pass builder. The pass builder is the main object used to construct and run pass pipelines. The <code>verify_each</code> keyword argument enables module verification after each pass, while <code>debug_logging</code> can be used to enable more output. Pass builder objects needs to be disposed after use.</p><p>Several other keyword arguments can be used to tune the pipeline. This only has an effect when using one of LLVM&#39;s default pipelines, like <code>default&lt;O3&gt;</code>:</p><ul><li><code>loop_interleaving::Bool=false</code>: Enable loop interleaving.</li><li><code>loop_vectorization::Bool=false</code>: Enable loop vectorization.</li><li><code>slp_vectorization::Bool=false</code>: Enable SLP vectorization.</li><li><code>loop_unrolling::Bool=false</code>: Enable loop unrolling.</li><li><code>forget_all_scev_in_loop_unroll::Bool=false</code>: Forget all SCEV information in loop unrolling.</li><li><code>licm_mssa_opt_cap::Int=0</code>: LICM MSSA optimization cap.</li><li><code>licm_mssa_no_acc_for_promotion_cap::Int=0</code>: LICM MSSA no access for promotion cap.</li><li><code>call_graph_profile::Bool=false</code>: Enable call graph profiling.</li><li><code>merge_functions::Bool=false</code>: Enable function merging.</li></ul><p>After a pass builder is constructed, custom passes can be registered with <code>register!</code>, passes or nested pass managers can be added with <code>add!</code>, and finally the passes can be run with <code>run!</code>:</p><pre><code class="language-julia hljs">@dispose pb = NewPMPassBuilder(verify_each=true) begin
    register!(pb, SomeCustomPass())
    add!(pb, SomeModulePass())
    add!(pb, NewPMFunctionPassManager()) do fpm
        add!(fpm, SomeFunctionPass())
    end
    run!(pb, mod, tm)
end</code></pre><p>For quickly running a simple pass or pipeline, a shorthand <code>run!</code> method is provided that obviates the construction of a <code>NewPMPassBuilder</code>:</p><pre><code class="language-julia hljs">run!(&quot;some-pass&quot;, mod, tm; verify_each=true)</code></pre><p>See also: <a href="#LLVM.register!"><code>register!</code></a>, <a href="#LLVM.add!"><code>add!</code></a>, <a href="#LLVM.run!"><code>run!</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/maleadt/LLVM.jl/blob/0ab0b7a7906d859221ad1bea03d534d94c0b3ff9/src/newpm.jl#L131-L176">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LLVM.run!" href="#LLVM.run!"><code>LLVM.run!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run!(pb::NewPMPassBuilder, mod::Module, [tm::TargetMachine])
run!(pipeline::String, mod::Module, [tm::TargetMachine])</code></pre><p>Run passes on a module. The passes are specified by a pass builder or a string that represents a pass pipeline. The target machine is used to optimize the passes.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/maleadt/LLVM.jl/blob/0ab0b7a7906d859221ad1bea03d534d94c0b3ff9/src/newpm.jl#L244-L250">source</a></section></article><h2 id="Pass-managers"><a class="docs-heading-anchor" href="#Pass-managers">Pass managers</a><a id="Pass-managers-1"></a><a class="docs-heading-anchor-permalink" href="#Pass-managers" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LLVM.NewPMPassManager" href="#LLVM.NewPMPassManager"><code>LLVM.NewPMPassManager</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">NewPMModulePassManager()
NewPMCGSCCPassManager()
NewPMFunctionPassManager()
NewPMLoopPassManager(; use_memory_ssa=false)
NewPMAAManager()</code></pre><p>Create a new pass manager of the specified type. These objects can be used to construct pass pipelines, by <code>add!</code>ing passes to them, and finally <code>add!</code>ing them to a parent pass manager or pass builder.</p><p>Creating a pass manager and adding it to a parent manager or builder can be shortened using a single <code>add!</code>:</p><pre><code class="language-julia hljs">add!(parent, NewPMModulePassManager()) do mpm
    add!(mpm, SomeModulePass())
end</code></pre><p>See also: <a href="#LLVM.add!"><code>add!</code></a>, <a href="#LLVM.NewPMPassBuilder"><code>NewPMPassBuilder</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/maleadt/LLVM.jl/blob/0ab0b7a7906d859221ad1bea03d534d94c0b3ff9/src/newpm.jl#L27-L48">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LLVM.add!" href="#LLVM.add!"><code>LLVM.add!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add!(pm::AbstractPassManager, pass)</code></pre><p>Adds a pass or pipeline to a pass builder or pass manager.</p><p>The pass or pipeline should be a string or string-convertible object known by LLVM. These can be constructed by using pass constructors, e.g., <code>InternalizePass()</code>, or by manually specifying names like <code>default&lt;O3&gt;</code>.</p><p>When using custom passes, remember that they need to be registered with the pass builder before they can be used.</p><p>See also: <a href="#LLVM.register!"><code>register!</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/maleadt/LLVM.jl/blob/0ab0b7a7906d859221ad1bea03d534d94c0b3ff9/src/newpm.jl#L11-L24">source</a></section></article><h2 id="Alias-analyses"><a class="docs-heading-anchor" href="#Alias-analyses">Alias analyses</a><a id="Alias-analyses-1"></a><a class="docs-heading-anchor-permalink" href="#Alias-analyses" title="Permalink"></a></h2><h2 id="Custom-passes"><a class="docs-heading-anchor" href="#Custom-passes">Custom passes</a><a id="Custom-passes-1"></a><a class="docs-heading-anchor-permalink" href="#Custom-passes" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LLVM.NewPMCustomPass" href="#LLVM.NewPMCustomPass"><code>LLVM.NewPMCustomPass</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">NewPMModulePass(name, callback)
NewPMFunctionPass(name, callback)</code></pre><p>Create a new custom pass. The <code>name</code> is a string that will be used to identify the pass in the pass manager. The <code>callback</code> is a function that will be called when the pass is run. The function should take a single argument, the module or function to be processed, and return a boolean indicating whether the pass made any changes.</p><p>Before using a custom pass, it must be registered with a pass builder using <code>register!</code>.</p><p>See also: <a href="#LLVM.register!"><code>register!</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/maleadt/LLVM.jl/blob/0ab0b7a7906d859221ad1bea03d534d94c0b3ff9/src/newpm.jl#L87-L99">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LLVM.register!" href="#LLVM.register!"><code>LLVM.register!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">register!(pb, custom_pass)</code></pre><p>Register a custom pass with the pass builder. This is necessary before the pass can be used in a pass pipeline.</p><p>See also: <a href="../hidden/#LLVM.NewPMModulePass"><code>NewPMModulePass</code></a>, <a href="../hidden/#LLVM.NewPMFunctionPass"><code>NewPMFunctionPass</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/maleadt/LLVM.jl/blob/0ab0b7a7906d859221ad1bea03d534d94c0b3ff9/src/newpm.jl#L232-L239">source</a></section></article><h2 id="IR-cloning"><a class="docs-heading-anchor" href="#IR-cloning">IR cloning</a><a id="IR-cloning-1"></a><a class="docs-heading-anchor-permalink" href="#IR-cloning" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LLVM.clone_into!" href="#LLVM.clone_into!"><code>LLVM.clone_into!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">clone_into!(new::LLVM.Function, old::LLVM.Function; [suffix::String],
            [value_map::Dict{&lt;:Value,&lt;:Value}],
            [changes::LLVM.LLVMCloneFunctionChangeType],
            [type_mapper::Function],
            [materializer::Function])</code></pre><p>Clone the contents of a function <code>old</code> into a new function <code>new</code>. The <code>value_map</code> dictionary can be used to remap values from the old function to the new function, while <code>suffix</code> appends a suffix to all values cloned. The <code>type_mapper</code> and <code>materializer</code> functions can be used to respectively map types and materialize values on demand.</p><p>The <code>changes</code> argument determines how this function behaves; refer to the LLVM documentation of <code>CloneFunctionInto</code> for more details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/maleadt/LLVM.jl/blob/0ab0b7a7906d859221ad1bea03d534d94c0b3ff9/src/utils.jl#L18-L32">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LLVM.clone" href="#LLVM.clone"><code>LLVM.clone</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">clone(f::Function; [value_map::Dict{Value,Value}])</code></pre><p>Simpler version of <a href="#LLVM.clone_into!"><code>clone_into!</code></a> that clones a function <code>f</code> into a new function, optionally mapping values according to the <code>value_map</code> dictionary.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/maleadt/LLVM.jl/blob/0ab0b7a7906d859221ad1bea03d534d94c0b3ff9/src/utils.jl#L61-L66">source</a></section><section><div><pre><code class="language-julia hljs">clone(bb::BasicBlock]; dest=parent(bb), [suffix::String], [value_map::Dict{Value,Value}])</code></pre><p>Clone a basic block <code>bb</code> by copying all instructions. The new block is inserted at the end of the parent function; this can be altered by setting <code>dest</code> to a different function, or to <code>nothing</code> to create a detached block. The <code>suffix</code> is appended to the name of the cloned basic block.</p><div class="admonition is-category-warn"><header class="admonition-header">Warn</header><div class="admonition-body"><p>This function only remaps values that are defined in the cloned basic block. Values defined outside the basic block (e.g. function arguments) are not remapped by default. This means that the cloned basic block can generally only be used within the same function that it was cloned from, unless you manually remap other values. This can be done passing a <code>value_map</code> dictionary.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/maleadt/LLVM.jl/blob/0ab0b7a7906d859221ad1bea03d534d94c0b3ff9/src/utils.jl#L105-L120">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../analyses/">« Analyses</a><a class="docs-footer-nextpage" href="../codegen/">Code generation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Thursday 5 September 2024 06:05">Thursday 5 September 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
